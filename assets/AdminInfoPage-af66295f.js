import{u as D,b as U,e as K,r as u,p as v,j as e,B as A,h as L}from"./index-29ebecb4.js";import{u as C}from"./useMutation-742de80f.js";import{u as R,C as o}from"./index.esm-28c77aa9.js";import{F as q}from"./Form-feffa48a.js";import{F as s,L as n}from"./Label-25c4d9a0.js";import{I as G}from"./Input-092d3532.js";import{A as M}from"./Alert-53afee14.js";import{D as i}from"./DisplayFormError-41029f3c.js";import{u as B}from"./useGetStoreInfo-c9315941.js";import{E as T}from"./ErrorDisplay-926af4d8.js";import{g as Q}from"./currency-symbol-map-2c95d993.js";import{G as f}from"./GenericInput-69b8ebf0.js";const V=()=>D("/api/update-store-admin-info",{errorMessage:"Failed to update store admin info"}),te=({handle:m})=>{const{authData:h}=U(),g=K(),[N,b]=u.useState(!1),{control:a,handleSubmit:S,reset:x,watch:k,formState:{errors:t}}=R({defaultValues:{name:"",handle:"",currency:"",twitterHandle:"",facebookPageName:"",facebookPageUrl:"",storeKeeperName:"",storeEmail:""}}),[p,E]=u.useState(null),j=k("currency"),P=B(m),{data:d,error:y,isLoading:F}=v(["storeInfo",m],()=>P(),{enabled:!!m&&h.isAuthenticated}),H=V(),c=C(H,{onSuccess:()=>{g(`/store-admin/${m}`)},onError:r=>{E(L(r))}});u.useEffect(()=>{d&&(x(d),b(!0))},[d,x]);const I=r=>{const w={storeName:r.name,handle:r.handle,currency:r.currency,twitterHandle:r.twitterHandle||null,instagramHandle:null,facebookPageName:r.facebookPageName||null,facebookPageUrl:r.facebookPageUrl||null,storeKeeperName:r.storeKeeperName||null,storeEmail:r.storeEmail};c.mutate(w)};if(F)return e.jsx("div",{children:"Loading..."});if(y)return e.jsx(T,{error:y});if(!N)return e.jsx("div",{children:"Preparing form..."});const l=r=>e.jsx(G,{...r,value:r.value||""});return e.jsxs("div",{className:"container mt-4",children:[e.jsx("h2",{children:"Store Admin Information"}),e.jsxs(q,{onSubmit:S(I),children:[e.jsxs(s,{children:[e.jsx(n,{for:"name",children:"Store Name"}),e.jsx(o,{name:"name",control:a,rules:{required:!0},render:({field:r})=>l({...r,type:"text",id:"name"})}),e.jsx(i,{error:t.name,fieldDisplayName:"Store Name"})]}),e.jsxs(s,{children:[e.jsx(n,{for:"handle",children:"Handle"}),e.jsx(o,{name:"handle",control:a,rules:{required:!0},render:({field:r})=>l({...r,type:"text",id:"handle"})}),e.jsx(i,{error:t.handle,fieldDisplayName:"Handle"})]}),e.jsxs(s,{children:[e.jsx(n,{for:"currency",children:"Currency"}),e.jsx(o,{name:"currency",control:a,rules:{required:!0},render:({field:r})=>l({...r,type:"text",id:"currency"})}),e.jsx(i,{error:t.currency,fieldDisplayName:"Currency"}),j&&e.jsxs("small",{className:"form-text text-muted",children:["Currency symbol: ",Q(j)]})]}),e.jsxs(s,{children:[e.jsx(n,{for:"twitterHandle",children:"Twitter Handle"}),e.jsx(o,{name:"twitterHandle",control:a,render:({field:r})=>e.jsx(f,{field:r,type:"text",id:"twitterHandle"})}),e.jsx(i,{error:t.twitterHandle,fieldDisplayName:"Twitter Handle"})]}),e.jsxs(s,{children:[e.jsx(n,{for:"facebookPageName",children:"Facebook Page Name"}),e.jsx(o,{name:"facebookPageName",control:a,render:({field:r})=>e.jsx(f,{field:r,type:"text",id:"twitterHandle"})}),e.jsx(i,{error:t.facebookPageName,fieldDisplayName:"Facebook Page Name"})]}),e.jsxs(s,{children:[e.jsx(n,{for:"facebookPageUrl",children:"Facebook Page URL"}),e.jsx(o,{name:"facebookPageUrl",control:a,render:({field:r})=>e.jsx(f,{field:r,type:"text",id:"facebookPageUrl"})}),e.jsx(i,{error:t.facebookPageUrl,fieldDisplayName:"Facebook Page URL"})]}),e.jsxs(s,{children:[e.jsx(n,{for:"storeKeeperName",children:"Store Keeper Name"}),e.jsx(o,{name:"storeKeeperName",control:a,render:({field:r})=>l({...r,type:"text",id:"storeKeeperName"})}),e.jsx(i,{error:t.storeKeeperName,fieldDisplayName:"Store Keeper Name"})]}),e.jsxs(s,{children:[e.jsx(n,{for:"storeEmail",children:"Store Email"}),e.jsx(o,{name:"storeEmail",control:a,rules:{required:!0},render:({field:r})=>l({...r,type:"email",id:"storeEmail"})}),e.jsx(i,{error:t.storeEmail,fieldDisplayName:"Store Email"})]}),p&&e.jsx(M,{color:"danger",children:p}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(A,{color:"primary",type:"submit",disabled:c.isLoading,children:c.isLoading?"Updating...":"Update Store"})})]})]})};export{te as default};
