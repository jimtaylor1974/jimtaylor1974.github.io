import{_ as N,R as d,a as v,j as e,B as C,w as E,u as L,r as i,p as z}from"./index-29ebecb4.js";import{S as $}from"./Spinner-99079439.js";import{E as I}from"./ErrorDisplay-926af4d8.js";import{D as P}from"./DateTime-ba55e20f.js";import{g as T,P as D}from"./Pagination-f8b1ecd4.js";import{T as B}from"./Table-2fae8ad2.js";import{F as b}from"./Form-feffa48a.js";import{F as a,L as n}from"./Label-25c4d9a0.js";import{I as u}from"./Input-092d3532.js";import{S as _}from"./Search-9d8b76b4.js";import{M as G,a as H,b as O}from"./ModalBody-4728dbd0.js";import{M as W}from"./ModalFooter-8a832faf.js";import{u as A}from"./useMutation-742de80f.js";import"./Alert-53afee14.js";import"./ButtonGroup-cb6cbaf6.js";import"./CardBody-f79b7743.js";import"./x-d20e24f6.js";var Q=["size","color"];function U(s){var o=s.size,c=o===void 0?24:o,t=s.color,l=t===void 0?"currentColor":t,h=N(s,Q);return d.createElement("svg",v({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-eye",width:c,height:c,viewBox:"0 0 24 24",stroke:l,strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},h),d.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.createElement("circle",{cx:"12",cy:"12",r:"2"}),d.createElement("path",{d:"M22 12c-2.667 4.667 -6 7 -10 7s-7.333 -2.333 -10 -7c2.667 -4.667 6 -7 10 -7s7.333 2.333 10 7"}))}const V=({viewMessage:s,setViewMessage:o,onToggleRead:c})=>{const t=()=>{o(null)};return e.jsxs(G,{isOpen:!0,toggle:t,size:"xl",children:[e.jsx(H,{toggle:t,children:"Contact form message"}),e.jsxs(O,{children:[e.jsxs(a,{children:[e.jsx(n,{className:"fw-bold",children:"Created on"}),e.jsx("div",{children:e.jsx(P,{val:s.createdOnLocal,utc:!1})})]}),e.jsxs(a,{children:[e.jsx(n,{className:"fw-bold",children:"IP address"}),e.jsx("div",{children:s.ipAddress})]}),e.jsxs(a,{children:[e.jsx(n,{className:"fw-bold",children:"Location info"}),e.jsx("div",{children:s.locationInfo})]}),e.jsxs(a,{children:[e.jsx(n,{className:"fw-bold",children:"Handle"}),e.jsx("div",{children:s.user&&s.user.handle})]}),e.jsxs(a,{children:[e.jsx(n,{className:"fw-bold",children:"Name"}),e.jsx("div",{children:s.name})]}),e.jsxs(a,{children:[e.jsx(n,{className:"fw-bold",children:"Email"}),e.jsx("div",{children:e.jsx("a",{href:`mailto:${s.email}`,children:s.email})})]}),e.jsxs(a,{children:[e.jsx(n,{className:"fw-bold",children:"Message"}),e.jsx("div",{children:s.message})]}),e.jsxs(a,{children:[e.jsx(n,{className:"fw-bold",children:"Read"}),e.jsx("div",{children:e.jsx(u,{type:"checkbox",checked:s.read,onChange:()=>c(s)})})]})]}),e.jsx(W,{children:e.jsx(C,{color:"secondary",onClick:t,children:"Close"})})]})},q=(s,o,c,t)=>E(`/api/contact-form-messages?page=${s}&perPage=${o}&search=${c}&includeRead=${t}`,{errorMessage:"Failed to get contact form messages"}),J=()=>L("/api/toggle-read-contact-form-message",{errorMessage:"Failed to toggle read status of contact form message"}),xe=()=>{const[s,o]=i.useState(null),[c,t]=i.useState(1),[l,h]=i.useState(T()),k=r=>{t(1),h(r)},[m,F]=i.useState(!1),[x,w]=i.useState(""),M=q(c,l,x,m),{data:j,error:p,isLoading:R,refetch:g}=z(["contactFormMessages",c,l,m,x],()=>M(),{keepPreviousData:!0}),S=A(J()),f=async r=>{await S.mutateAsync({id:r.id},{onSuccess:()=>{r.read=!r.read,g()}})},y=r=>{o(r)};return e.jsxs(e.Fragment,{children:[s&&e.jsx(V,{viewMessage:s,setViewMessage:o,onToggleRead:f}),e.jsx("h1",{children:"Contact form messages"}),R&&e.jsx($,{}),p&&e.jsx(I,{error:p,title:"Unable to fetch contact form messages",onDismiss:()=>g()}),j&&e.jsxs(e.Fragment,{children:[e.jsx(_,{searchText:x,onSearch:w,children:e.jsx(b,{inline:!0,children:e.jsx(a,{check:!0,children:e.jsxs(n,{check:!0,children:[e.jsx(u,{type:"checkbox",checked:m,onChange:r=>F(r.target.checked)})," ","Include read"]})})})}),e.jsxs(B,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Created on"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Message"}),e.jsx("th",{children:"Read"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:j.items.map(r=>e.jsxs("tr",{className:r.read?"bg-light":"",children:[e.jsx("td",{children:e.jsx(P,{val:r.createdOnLocal,utc:!1})}),e.jsx("td",{children:r.name}),e.jsx("td",{children:r.email}),e.jsx("td",{children:r.message}),e.jsx("td",{children:e.jsx(b,{children:e.jsx(a,{switch:!0,children:e.jsx(u,{type:"switch",checked:r.read,onChange:()=>f(r)})})})}),e.jsx("td",{children:e.jsxs(C,{size:"sm",outline:!0,onClick:()=>y(r),children:[e.jsx(U,{className:"me-1"}),"view"]})})]},r.id))})]}),e.jsx(D,{pagedResult:j,onPageSelected:t,perPage:l,onPerPageSelected:k})]})]})};export{xe as default};
