import{R as u,t as H,P as f,o as le,m as J,c as v,r as y,_ as ce,a as ue,u as C,b as me,d as de,e as pe,f as fe,j as e,C as he,N as ge,g as F,B as j,L as A,Q as $,h as B}from"./index-29ebecb4.js";import{H as ye}from"./Helmet-3f1c463b.js";import{u as ve,C as be}from"./index.esm-28c77aa9.js";import{u as w}from"./useMutation-742de80f.js";import{R as D,C as g}from"./Col-7106f25e.js";import{N as q}from"./NavLink-acd9745e.js";import{C as xe,a as je}from"./CardBody-f79b7743.js";import{F as W}from"./Form-feffa48a.js";import{F as E,L as O}from"./Label-25c4d9a0.js";import{I as N}from"./Input-092d3532.js";import{A as we}from"./Alert-53afee14.js";import{S as Ee}from"./SocialLogins-e9a4aab6.js";import{D as Oe}from"./DisplayFormError-41029f3c.js";import{E as z}from"./ErrorDisplay-926af4d8.js";import{u as Ne}from"./useLocalStorage-c1e4b9b7.js";import{C as Pe}from"./CheckFromEmailSpamJunkWarning-4d01aed3.js";import"./useSocialAuthLogin-942c6414.js";import"./types-9dadba29.js";var U=u.createContext({});function P(t){"@babel/helpers - typeof";return P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},P(t)}function T(){return T=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},T.apply(this,arguments)}function Te(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function V(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Se(t,r,s){return r&&V(t.prototype,r),s&&V(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function _e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&S(t,r)}function S(t,r){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},S(t,r)}function ke(t){var r=Re();return function(){var n=b(t),a;if(r){var i=b(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Ce(this,a)}}function Ce(t,r){if(r&&(P(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Le(t)}function Le(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Re(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},b(t)}var G={tag:H,activeTab:f.any,className:f.string,cssModule:f.object},Q=function(t){_e(s,t);var r=ke(s);function s(n){var a;return Te(this,s),a=r.call(this,n),a.state={activeTab:a.props.activeTab},a}return Se(s,[{key:"render",value:function(){var a=this.props,i=a.className,m=a.cssModule,l=a.tag,d=l===void 0?"div":l,c=le(this.props,Object.keys(G)),x=J(v("tab-content",i),m);return u.createElement(U.Provider,{value:{activeTabId:this.state.activeTab}},u.createElement(d,T({},c,{className:x})))}}],[{key:"getDerivedStateFromProps",value:function(a,i){return i.activeTab!==a.activeTab?{activeTab:a.activeTab}:null}}]),s}(y.Component);const Me=Q;Q.propTypes=G;var Ie=["className","cssModule","tabId","tag"];function _(){return _=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},_.apply(this,arguments)}function Fe(t,r){if(t==null)return{};var s=Ae(t,r),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Ae(t,r){if(t==null)return{};var s={},n=Object.keys(t),a,i;for(i=0;i<n.length;i++)a=n[i],!(r.indexOf(a)>=0)&&(s[a]=t[a]);return s}var $e={tag:H,className:f.string,cssModule:f.object,tabId:f.any};function k(t){var r=t.className,s=t.cssModule,n=t.tabId,a=t.tag,i=a===void 0?"div":a,m=Fe(t,Ie),l=function(c){return J(v("tab-pane",r,{active:n===c}),s)};return u.createElement(U.Consumer,null,function(d){var c=d.activeTabId;return u.createElement(i,_({},m,{className:l(c)}))})}k.propTypes=$e;var Be=["size","color"];function De(t){var r=t.size,s=r===void 0?24:r,n=t.color,a=n===void 0?"currentColor":n,i=ce(t,Be);return u.createElement("svg",ue({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-login",width:s,height:s,viewBox:"0 0 24 24",stroke:a,strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},i),u.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),u.createElement("path",{d:"M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2"}),u.createElement("path",{d:"M20 12h-13l3 -3m0 6l-3 -3"}))}const qe=()=>C("tokens",{errorMessage:"Failed to request token"}),We=()=>C("/api/resend-email-confirmation-email",{errorMessage:"Failed to resend email confirmation email"}),ze=()=>C("/api/login-with-email",{errorMessage:"Failed to login with email"}),lt=()=>{var I;const t=me(),{state:r}=de(),s=pe(),[n,a]=y.useState(null),[i,m]=y.useState(!1),[l,d]=Ne("LoginTab","password"),{auth:c}=fe(),x=c.microsoft.enabled||c.google.enabled||c.facebook.enabled,{control:Y,handleSubmit:K,formState:{errors:X},clearErrors:L}=ve({defaultValues:{email:""},mode:"onChange"}),[p,R]=y.useState({grantType:"password",refreshToken:"",username:"",password:""}),Z=w(qe()),ee=w(We(),{onSuccess:()=>{$.success("Confirmation email has been resent.")},onError:o=>{a(B(o))}}),te=w(ze(),{onSuccess:()=>{$.success("Please check your email for a login link.")},onError:o=>{a(B(o))}}),re="Discover VintageAndPreOwned.com: Revolutionizing vintage fashion resale with AI-powered listings. Browse unique pre-loved items or list your own on our exclusive marketplace and popular platforms like eBay and Etsy. Join our sustainable fashion movement!",ne=o=>{t.onAuthenticated(o);const h=(r==null?void 0:r.redir)||"/";s(h)},ae=async o=>{o.preventDefault(),m(!0);try{const h=await Z.mutateAsync(p);ne(h)}catch(h){a(h)}finally{m(!1)}},se=o=>{a(null),L(),te.mutate(o)},M=o=>{l!==o&&(d(o),a(null),L())},oe=async()=>{m(!0);try{const o={handleOrEmail:p.username};await ee.mutateAsync(o)}catch(o){a(o)}finally{m(!1)}},ie=(((I=n==null?void 0:n.data)==null?void 0:I.error)??"")==="unconfirmed_email";return e.jsxs(he,{className:"my-5",children:[e.jsxs(ye,{children:[e.jsx("title",{children:"Vintage and Pre-Owned - Login"}),e.jsx("meta",{property:"og:title",content:"Vintage and Pre-Owned - Login"}),e.jsx("meta",{property:"og:description",content:re}),e.jsx("meta",{property:"og:url",content:window.location.href}),e.jsx("meta",{property:"og:type",content:"website"})]}),e.jsxs(D,{className:"justify-content-center",children:[e.jsxs(g,{xs:12,md:8,lg:6,children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("img",{src:"/images/logo.png",style:{width:"150px"},alt:"Vintage & Pre-Owned Logo"}),e.jsx("h2",{className:"mt-2",children:"Welcome Back!"}),e.jsx("p",{className:"text-muted",children:"Log in to continue to VintageAndPreOwned.com"})]}),e.jsx(xe,{children:e.jsxs(je,{children:[e.jsxs(ge,{tabs:!0,className:"justify-content-center mb-4",children:[e.jsx(F,{children:e.jsx(q,{className:v({active:l==="password"}),onClick:()=>M("password"),children:"Password Login"})}),e.jsx(F,{children:e.jsx(q,{className:v({active:l==="email"}),onClick:()=>M("email"),children:"Email Login"})})]}),e.jsxs(Me,{activeTab:l,children:[e.jsx(k,{tabId:"password",children:e.jsxs(W,{onSubmit:ae,children:[e.jsxs(E,{children:[e.jsx(O,{for:"username",children:"Username or Email"}),e.jsx(N,{type:"text",id:"username",placeholder:"Enter your username or email",value:p.username,onChange:o=>R({...p,username:o.target.value})})]}),e.jsxs(E,{children:[e.jsx(O,{for:"password",children:"Password"}),e.jsx(N,{type:"password",id:"password",placeholder:"Enter your password",value:p.password,onChange:o=>R({...p,password:o.target.value})})]}),e.jsx(z,{error:n}),ie&&e.jsxs(we,{color:"warning",children:[e.jsx("p",{className:"mb-2",children:"Your email address is not confirmed. Please confirm your email to proceed."}),e.jsx(j,{color:"warning",onClick:oe,disabled:i,children:"Resend Confirmation Email"})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx(A,{to:"/forgot-password",className:"text-muted",children:"Forgot password?"}),e.jsxs(j,{color:"primary",type:"submit",disabled:i,children:[e.jsx(De,{size:16,className:"me-2"}),"Log In"]})]})]})}),e.jsx(k,{tabId:"email",children:e.jsxs(W,{onSubmit:K(se),children:[e.jsxs(E,{children:[e.jsx(O,{for:"email",children:"Email"}),e.jsx(be,{control:Y,name:"email",rules:{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email address"}},render:({field:o})=>e.jsx(N,{type:"email",id:"email",placeholder:"Enter your email",...o})}),e.jsx(Oe,{error:X.email,fieldDisplayName:"Email"})]}),e.jsx(Pe,{}),e.jsx(z,{error:n}),e.jsx("div",{className:"text-end",children:e.jsx(j,{color:"primary",type:"submit",disabled:i,children:"Send Login Link"})})]})})]}),x&&e.jsxs("div",{className:"text-center mt-4",children:[e.jsx("p",{className:"text-muted",children:"Or log in with"}),e.jsx(Ee,{registration:!1})]})]})}),e.jsx("div",{className:"text-center mt-4",children:e.jsxs("p",{className:"text-muted",children:["Don't have an account?"," ",e.jsx(A,{to:"/register",children:"Create one now"})]})})]}),e.jsxs(g,{xs:12,md:8,lg:6,className:"mt-5",children:[e.jsx("h4",{className:"text-center",children:"Why Join VintageAndPreOwned.com?"}),e.jsxs(D,{className:"mt-4",children:[e.jsxs(g,{md:6,children:[e.jsx("h5",{children:"For Buyers"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Browse unique vintage items from multiple sellers"}),e.jsx("li",{children:"Save your favorite searches for quick access"}),e.jsx("li",{children:"Enjoy a curated shopping experience"})]})]}),e.jsxs(g,{md:6,children:[e.jsx("h5",{children:"For Sellers"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Easy and intuitive listing creation"}),e.jsx("li",{children:"Reach a targeted audience of vintage enthusiasts"}),e.jsx("li",{children:"Access sales and inventory reporting tools"})]})]})]})]})]})]})};export{lt as default};
